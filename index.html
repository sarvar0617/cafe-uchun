<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mazali Ovqatlar - Yetkazib berish xizmatilari mavjud </title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary: #e35420;
            --secondary: #2f4858;
            --accent: #f7931e;
            --light: #f8f9fa;
            --dark: #343a40;
            --success: #28a745;
            --danger: #dc3545;
            --info: #17a2b8;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        /* Header styles */
        header {
            background-color: var(--primary);
            color: white;
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            display: flex;
            align-items: center;
        }
        
        .logo i {
            margin-right: 10px;
        }
        
        nav ul {
            display: flex;
            list-style: none;
        }
        
        nav ul li {
            margin-left: 1.5rem;
        }
        
        nav ul li a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        nav ul li a:hover {
            color: var(--secondary);
        }
        
        .cart-icon, .chat-icon {
            position: relative;
            cursor: pointer;
            margin-left: 15px;
        }
        
        .cart-count {
            position: absolute;
            top: -10px;
            right: -10px;
            background-color: var(--secondary);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 0.8rem;
        }
        
        /* Hero section */
        .hero {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?ixlib=rb-4.0.3&auto=format&fit=crop&w=1600&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 4rem 0;
            text-align: center;
        }
        
        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        
        .hero p {
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto 2rem;
        }
        
        .btn {
            display: inline-block;
            background-color: var(--primary);
            color: white;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
        }
        
        .btn:hover {
            background-color: var(--accent);
            transform: translateY(-3px);
        }
        
        .btn-success {
            background-color: var(--success);
        }
        
        .btn-success:hover {
            background-color: #218838;
        }
        
        .btn-danger {
            background-color: var(--danger);
        }
        
        .btn-danger:hover {
            background-color: #c82333;
        }
        
        .btn-info {
            background-color: var(--info);
        }
        
        .btn-info:hover {
            background-color: #138496;
        }
        
        /* Categories section */
        .categories {
            padding: 3rem 0;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--secondary);
            position: relative;
            padding-bottom: 10px;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background-color: var(--primary);
        }
        
        .category-filters {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 2rem;
            gap: 10px;
        }
        
        .category-filter {
            background-color: white;
            border: 1px solid #ddd;
            padding: 0.5rem 1rem;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .category-filter.active, .category-filter:hover {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        /* Food items */
        .food-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
        }
        
        .food-card {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
            position: relative;
        }
        
        .food-card:hover {
            transform: translateY(-10px);
        }
        
        .food-image {
            height: 200px;
            overflow: hidden;
        }
        
        .food-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s;
            background-color: #f5f5f5; /* Placeholder background */
        }
        
        .food-card:hover .food-image img {
            transform: scale(1.1);
        }
        
        .food-info {
            padding: 1.5rem;
        }
        
        .food-title {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            color: var(--secondary);
        }
        
        .food-description {
            color: #666;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }
        
        .food-price {
            font-weight: bold;
            color: var(--primary);
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }
        
        .food-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .quantity {
            display: flex;
            align-items: center;
        }
        
        .quantity-btn {
            background-color: #eee;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            font-weight: bold;
        }
        
        .quantity-input {
            width: 40px;
            text-align: center;
            border: none;
            margin: 0 5px;
            font-weight: bold;
        }
        
        .delete-food {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            display: none;
        }
        
        .admin-mode .delete-food {
            display: block;
        }
        
        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            padding: 2rem;
            position: relative;
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            color: #999;
        }
        
        .close-modal:hover {
            color: var(--danger);
        }
        
        .cart-items {
            margin: 1.5rem 0;
        }
        
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid #eee;
        }
        
        .cart-item-info {
            flex: 1;
            padding-right: 1rem;
        }
        
        .cart-item-title {
            font-weight: 500;
        }
        
        .cart-item-price {
            color: var(--primary);
            font-weight: bold;
        }
        
        .cart-total {
            display: flex;
            justify-content: space-between;
            font-size: 1.2rem;
            font-weight: bold;
            margin: 1.5rem 0;
            padding-top: 1rem;
            border-top: 2px solid #eee;
        }
        
        /* Checkout form */
        .checkout-form {
            margin-top: 2rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        /* Admin panel */
        .admin-panel {
            background-color: var(--secondary);
            padding: 10px 0;
            text-align: center;
            position: fixed;
            bottom: 0;
            width: 100%;
            z-index: 100;
        }
        
        .admin-panel a {
            color: white;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
        }
        
        .admin-panel i {
            margin-right: 8px;
        }
        
        /* Admin login modal */
        .admin-login-form {
            max-width: 400px;
            margin: 2rem auto;
        }
        
        /* Chat section */
        .chat-container {
            border: 1px solid #ddd;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 2rem;
        }
        
        .chat-header {
            background-color: var(--secondary);
            color: white;
            padding: 1rem;
            text-align: center;
        }
        
        .chat-messages {
            height: 300px;
            overflow-y: auto;
            padding: 1rem;
            background-color: #f9f9f9;
        }
        
        .message {
            margin-bottom: 1rem;
            padding: 0.8rem;
            border-radius: 10px;
            max-width: 80%;
        }
        
        .message.admin {
            background-color: #e3f2fd;
            margin-right: auto;
        }
        
        .message.user {
            background-color: #ffecb3;
            margin-left: auto;
        }
        
        .message-time {
            font-size: 0.7rem;
            color: #777;
            margin-top: 5px;
            text-align: right;
        }
        
        .chat-input {
            display: flex;
            padding: 1rem;
            background-color: white;
            border-top: 1px solid #ddd;
        }
        
        .chat-input input {
            flex: 1;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 30px;
            margin-right: 10px;
        }
        
        /* Admin panel styles */
        .admin-dashboard {
            display: none;
            padding: 2rem;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin: 2rem 0;
        }
        
        .admin-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .admin-card {
            background-color: var(--light);
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
        }
        
        .admin-card h3 {
            margin-bottom: 1rem;
            color: var(--secondary);
        }
        
        /* Footer */
        footer {
            background-color: var(--dark);
            color: white;
            padding: 2rem 0;
            margin-top: 3rem;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }
        
        .footer-section h3 {
            margin-bottom: 1rem;
            position: relative;
            padding-bottom: 10px;
        }
        
        .footer-section h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 50px;
            height: 2px;
            background-color: var(--primary);
        }
        
        /* Payment section */
        .payment-methods {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 1rem 0;
        }
        
        .payment-method {
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .payment-method.selected {
            border-color: var(--primary);
            background-color: #fff5e6;
        }
        
        .screenshot-upload {
            margin-top: 1rem;
            display: none;
        }
        
        /* Orders section */
        .orders-list {
            margin-top: 1rem;
        }
        
        .order-item {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .order-status {
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .order-status.pending {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .order-status.completed {
            background-color: #d4edda;
            color: #155724;
        }
        
        /* Image upload styles */
        .image-upload-container {
            margin: 1rem 0;
        }
        
        .image-preview {
            width: 100%;
            height: 200px;
            border: 2px dashed #ddd;
            border-radius: 5px;
            margin-top: 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            background-color: #f9f9f9;
        }
        
        .image-preview img {
            max-width: 100%;
            max-height: 100%;
            object-fit: cover;
        }
        
        .image-preview-text {
            color: #999;
            text-align: center;
            padding: 1rem;
        }
        
        /* Yangi uslublar */
        .user-chat-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 1rem;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .user-chat-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .user-chat-item:hover {
            background-color: #f5f5f5;
        }
        
        .user-chat-item.active {
            background-color: #e3f2fd;
        }
        
        .user-info {
            display: flex;
            flex-direction: column;
        }
        
        .user-name {
            font-weight: bold;
        }
        
        .user-phone {
            font-size: 0.8rem;
            color: #777;
        }
        
        .unread-count {
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 0.8rem;
        }
        
        .chat-image {
            max-width: 200px;
            max-height: 200px;
            border-radius: 5px;
            margin-top: 5px;
        }
        
        .category-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .category-actions {
            display: flex;
            gap: 10px;
        }
        
        /* Payment screenshot in orders */
        .payment-screenshot {
            max-width: 100%;
            max-height: 200px;
            border-radius: 5px;
            margin-top: 10px;
            border: 1px solid #ddd;
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            nav ul {
                margin-top: 1rem;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            nav ul li {
                margin: 0.5rem;
            }
            
            .hero h1 {
                font-size: 2rem;
            }
            
            .hero p {
                font-size: 1rem;
            }
            
            .food-items {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            .admin-actions {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header Section -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-utensils"></i>
                    <span>Mazali Ovqatlar</span>
                </div>
                <nav>
                    <ul>
                        <li><a href="#" class="active">Bosh Sahifa</a></li>
                        <li><a href="#">Menu</a></li>
                        <li><a href="#">Biz Haqimizda</a></li>
                        <li><a href="#">Bog'lanish</a></li>
                        <li>
                            <div class="cart-icon" id="cartIcon">
                                <i class="fas fa-shopping-cart"></i>
                                <span class="cart-count">0</span>
                            </div>
                        </li>
                        <li>
                            <div class="chat-icon" id="chatIcon">
                                <i class="fas fa-comments"></i>
                            </div>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <h1>Mazali Taomlargizni Biz Yetkazib Beramiz</h1>
            <p>Eng mazali va sifatli taomlar faqat bizda! Tez va bepul yetkazib berish xizmati.</p>
            <a href="#foods" class="btn">Buyurtma Berish</a>
        </div>
    </section>

    <!-- Categories Section -->
    <section class="categories" id="foods">
        <div class="container">
            <h2 class="section-title">Bizning Menu</h2>
            
            <div class="category-filters" id="categoryFilters">
                <!-- Categories will be loaded here by JavaScript -->
            </div>
            
            <div class="food-items" id="foodItemsContainer">
                <!-- Food items will be loaded here by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Admin Dashboard (initially hidden) -->
    <div class="container">
        <div class="admin-dashboard" id="adminDashboard">
            <h2 class="section-title">Admin Panel</h2>
            
            <div class="admin-actions">
                <div class="admin-card">
                    <h3>Taom Qo'shish</h3>
                    <button class="btn" id="addFoodBtn">Yangi Taom</button>
                </div>
                
                <div class="admin-card">
                    <h3>Kategoriya Qo'shish</h3>
                    <button class="btn" id="addCategoryBtn">Yangi Kategoriya</button>
                </div>
                
                <div class="admin-card">
                    <h3>Kategoriyalarni Boshqarish</h3>
                    <button class="btn" id="manageCategoriesBtn">Kategoriyalar</button>
                </div>
                
                <div class="admin-card">
                    <h3>Buyurtmalar</h3>
                    <button class="btn" id="viewOrdersBtn">Buyurtmalarni Ko'rish</button>
                </div>

                <div class="admin-card">
                    <h3>Admin Rejimi</h3>
                    <button class="btn btn-danger" id="toggleAdminMode">Yopish</button>
                </div>
            </div>
            
            <div class="chat-container">
                <div class="user-chat-list" id="userChatList">
                    <!-- Foydalanuvchilar chat ro'yxati -->
                </div>
                
                <div class="chat-header">
                    <h3>Foydalanuvchilar bilan Chat</h3>
                </div>
                
                <div class="chat-messages" id="adminChatMessages">
                    <div class="message admin">
                        <p>Xush kelibsiz, Admin! Bu yerda mijozlar bilan muloqot qilishingiz mumkin.</p>
                        <div class="message-time" id="adminTime"></div>
                    </div>
                </div>
                
                <div class="chat-input">
                    <input type="text" id="adminMessageInput" placeholder="Xabaringizni yozing...">
                    <button class="btn" id="adminSendMessageBtn"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart Modal -->
    <div class="modal" id="cartModal">
        <div class="modal-content">
            <span class="close-modal" id="closeCart">&times;</span>
            <h2>Savat</h2>
            
            <div class="cart-items" id="cartItemsContainer">
                <!-- Cart items will be loaded here -->
            </div>
            
            <div class="cart-total">
                <span>Jami:</span>
                <span id="cartTotal">0 so'm</span>
            </div>
            
            <button class="btn" id="checkoutBtn">Buyurtma Berish</button>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div class="modal" id="checkoutModal">
        <div class="modal-content">
            <span class="close-modal" id="closeCheckout">&times;</span>
            <h2>Buyurtma Berish</h2>
            
            <form class="checkout-form" id="checkoutForm">
                <div class="form-group">
                    <label for="name">Ismingiz</label>
                    <input type="text" id="name" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="phone">Telefon Raqami</label>
                    <input type="tel" id="phone" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="address">Manzil</label>
                    <textarea id="address" class="form-control" rows="3" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>To'lov Usuli</label>
                    <div class="payment-methods">
                        <div class="payment-method selected" data-method="cash">
                            <i class="fas fa-money-bill-wave"></i> Naqd
                        </div>
                        <div class="payment-method" data-method="card">
                            <i class="fas fa-credit-card"></i> Karta
                        </div>
                        <div class="payment-method" data-method="online">
                            <i class="fas fa-mobile-alt"></i> Onlayn
                        </div>
                    </div>
                </div>
                
                <div class="screenshot-upload" id="screenshotUpload">
                    <label for="screenshot">To'lov chekini yuklang (screenshot)</label>
                    <input type="file" id="screenshot" class="form-control" accept="image/*">
                    <div class="image-preview" id="paymentScreenshotPreview">
                        <div class="image-preview-text">Rasm ko'rinishi</div>
                    </div>
                </div>
                
                <button type="submit" class="btn">Buyurtmani Tasdiqlash</button>
            </form>
        </div>
    </div>

    <!-- Chat Modal -->
    <div class="modal" id="chatModal">
        <div class="modal-content">
            <span class="close-modal" id="closeChat">&times;</span>
            <h2>Admin bilan Chat</h2>
            
            <div class="chat-container">
                <div class="chat-header">
                    <h3>Qo'llab-quvvatlash xizmati</h3>
                </div>
                
                <div class="chat-messages" id="chatMessages">
                    <div class="message admin">
                        <p>Salom! Savollaringiz bo'lsa, menga yozishingiz mumkin.</p>
                        <div class="message-time" id="userTime"></div>
                    </div>
                </div>
                
                <div class="chat-input">
                    <input type="text" id="messageInput" placeholder="Xabaringizni yozing...">
                    <button class="btn" id="sendMessageBtn"><i class="fas fa-paper-plane"></i></button>
                    <button class="btn" id="uploadImageBtn"><i class="fas fa-image"></i></button>
                    <input type="file" id="chatImageInput" accept="image/*" style="display: none;">
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div class="modal" id="adminLoginModal">
        <div class="modal-content">
            <span class="close-modal" id="closeAdminLogin">&times;</span>
            <h2>Admin Kirish</h2>
            
            <form class="admin-login-form" id="adminLoginForm">
                <div class="form-group">
                    <label for="adminPassword">Parol</label>
                    <input type="password" id="adminPassword" class="form-control" required>
                </div>
                
                <button type="submit" class="btn">Kirish</button>
            </form>
        </div>
    </div>

    <!-- Add Food Modal -->
    <div class="modal" id="addFoodModal">
        <div class="modal-content">
            <span class="close-modal" id="closeAddFood">&times;</span>
            <h2>Yangi Taom Qo'shish</h2>
            
            <form class="checkout-form" id="addFoodForm">
                <div class="form-group">
                    <label for="foodName">Taom Nomi</label>
                    <input type="text" id="foodName" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="foodDescription">Taom Tavsifi</label>
                    <textarea id="foodDescription" class="form-control" rows="3" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="foodPrice">Narxi (so'm)</label>
                    <input type="number" id="foodPrice" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="foodCategory">Kategoriya</label>
                    <select id="foodCategory" class="form-control" required>
                        <!-- Categories will be loaded here -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="foodImage">Rasm</label>
                    <input type="file" id="foodImage" class="form-control" accept="image/*" required>
                    <div class="image-upload-container">
                        <div class="image-preview" id="imagePreview">
                            <div class="image-preview-text">Rasm ko'rinishi</div>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="btn">Taom Qo'shish</button>
            </form>
        </div>
    </div>

    <!-- Add Category Modal -->
    <div class="modal" id="addCategoryModal">
        <div class="modal-content">
            <span class="close-modal" id="closeAddCategory">&times;</span>
            <h2>Yangi Kategoriya Qo'shish</h2>
            
            <form class="checkout-form" id="addCategoryForm">
                <div class="form-group">
                    <label for="categoryName">Kategoriya Nomi</label>
                    <input type="text" id="categoryName" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="categoryId">Kategoriya ID (lotincha)</label>
                    <input type="text" id="categoryId" class="form-control" required>
                </div>
                
                <button type="submit" class="btn">Kategoriya Qo'shish</button>
            </form>
        </div>
    </div>

    <!-- Manage Categories Modal -->
    <div class="modal" id="manageCategoriesModal">
        <div class="modal-content">
            <span class="close-modal" id="closeManageCategories">&times;</span>
            <h2>Kategoriyalarni Boshqarish</h2>
            
            <div class="categories-list" id="categoriesList">
                <!-- Kategoriyalar ro'yxati -->
            </div>
            
            <button class="btn" id="addNewCategoryBtn">Yangi Kategoriya Qo'shish</button>
        </div>
    </div>

    <!-- Orders Modal -->
    <div class="modal" id="ordersModal">
        <div class="modal-content">
            <span class="close-modal" id="closeOrders">&times;</span>
            <h2>Buyurtmalar Ro'yxati</h2>
            
            <div class="orders-list" id="ordersList">
                <!-- Orders will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Admin Panel Link -->
    <div class="admin-panel">
        <a href="#" id="adminLoginLink">
            <i class="fas fa-lock"></i> Admin Paneliga Kirish
        </a>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Biz Haqimizda</h3>
                    <p>Biz eng mazali va sifatli ovqatlarni tez yetkazib berish bilan mashhurmiz. Sizning mamnunligingiz - bizning safarimiz.</p>
                </div>
                
                <div class="footer-section">
                    <h3>Bog'lanish</h3>
                    <p><i class="fas fa-phone"></i> +998 90 123 45 67</p>
                    <p><i class="fas fa-envelope"></i> info@mazaliovqatlar.uz</p>
                    <p><i class="fas fa-map-marker-alt"></i> Samarqand, Juma shahri</p>
                </div>
                
                <div class="footer-section">
                    <h3>Ish Soatlarimiz</h3>
                    <p>Dushanba - Juma: 9:00 - 23:00</p>
                    <p>Shanba - Yakshanba: 10:00 - 00:00</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Data storage
        let foodItems = JSON.parse(localStorage.getItem('foodItems')) || [
            {
                id: 1,
                name: "Mol Go'shtli Lavash",
                description: "Xamir, mol go'shti, yangi sabzavotlar va maxsus sous",
                price: 25000,
                image: "https://images.unsplash.com/photo-1640673728969-525c91a6e4f2?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
                category: "lavash"
            },
            {
                id: 2,
                name: "Tovuq Go'shtli Lavash",
                description: "Xamir, tovuq go'shti, yangi sabzavotlar va maxsus sous",
                price: 22000,
                image: "https://images.unsplash.com/photo-1615876234886-fd9a39fda97f?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
                category: "lavash"
            },
            {
                id: 3,
                name: "Peperoni Pizza",
                description: "Qalami, peperoni, pishloq va pomidor sousi",
                price: 65000,
                image: "https://images.unsplash.com/photo-1628840042765-356cda07504e?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
                category: "pizza"
            },
            {
                id: 4,
                name: "Margarita Pizza",
                description: "Pomidor, pishloq, bazilik va zaytun moyi",
                price: 60000,
                image: "https://images.unsplash.com/photo-1593560708920-61dd98c46a4e?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
                category: "pizza"
            },
            {
                id: 5,
                name: "Coca-Cola",
                description: "0.5L sovuq Coca-Cola",
                price: 8000,
                image: "https://images.unsplash.com/photo-1554866585-cd94860890b7?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
                category: "ichimlik"
            },
            {
                id: 6,
                name: "Fanta",
                description: "0.5L sovuq Fanta",
                price: 8000,
                image: "https://images.unsplash.com/photo-1622480771645-0f7c5d5c5b5e?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
                category: "ichimlik"
            },
            {
                id: 7,
                name: "Sezar Salati",
                description: "Karam, tovuq go'shti, krutonlar va Sezar sousi",
                price: 28000,
                image: "https://images.unsplash.com/photo-1546793665-c74683f339c1?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
                category: "salat"
            },
            {
                id: 8,
                name: "Yunon Salati",
                description: "Bodring, pomidor, piyoz, zaytun va pishloq",
                price: 24000,
                image: "https://images.unsplash.com/photo-1512621776951-a57141f2eefd?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
                category: "salat"
            }
        ];

        // Categories
        let categories = JSON.parse(localStorage.getItem('categories')) || [
            { id: "all", name: "Hammasi" },
            { id: "lavash", name: "Lavash" },
            { id: "pizza", name: "Pizza" },
            { id: "ichimlik", name: "Ichimliklar" },
            { id: "salat", name: "Salatlar" }
        ];

        // Orders
        let orders = JSON.parse(localStorage.getItem('orders')) || [];

        // Chat messages
        let chatMessages = JSON.parse(localStorage.getItem('chatMessages')) || [
            {
                sender: 'admin',
                message: 'Salom! Savollaringiz bo\'lsa, menga yozishingiz mumkin.',
                time: new Date().toLocaleTimeString()
            }
        ];

        // Cart state
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let currentPaymentMethod = 'cash';
        let isAdminMode = false;

        // Yangi o'zgaruvchilar
        let userChats = JSON.parse(localStorage.getItem('userChats')) || {};
        let activeChatUserId = null;
        let unreadMessages = JSON.parse(localStorage.getItem('unreadMessages')) || {};

        // DOM Elements
        const foodItemsContainer = document.getElementById('foodItemsContainer');
        const categoryFiltersContainer = document.getElementById('categoryFilters');
        const cartIcon = document.getElementById('cartIcon');
        const chatIcon = document.getElementById('chatIcon');
        const cartModal = document.getElementById('cartModal');
        const closeCart = document.getElementById('closeCart');
        const cartItemsContainer = document.getElementById('cartItemsContainer');
        const cartTotalElement = document.getElementById('cartTotal');
        const cartCountElement = document.querySelector('.cart-count');
        const checkoutBtn = document.getElementById('checkoutBtn');
        const checkoutModal = document.getElementById('checkoutModal');
        const closeCheckout = document.getElementById('closeCheckout');
        const checkoutForm = document.getElementById('checkoutForm');
        const chatModal = document.getElementById('chatModal');
        const closeChat = document.getElementById('closeChat');
        const chatMessagesContainer = document.getElementById('chatMessages');
        const messageInput = document.getElementById('messageInput');
        const sendMessageBtn = document.getElementById('sendMessageBtn');
        const adminLoginLink = document.getElementById('adminLoginLink');
        const adminLoginModal = document.getElementById('adminLoginModal');
        const closeAdminLogin = document.getElementById('closeAdminLogin');
        const adminLoginForm = document.getElementById('adminLoginForm');
        const adminPassword = document.getElementById('adminPassword');
        const adminDashboard = document.getElementById('adminDashboard');
        const adminChatMessages = document.getElementById('adminChatMessages');
        const adminMessageInput = document.getElementById('adminMessageInput');
        const adminSendMessageBtn = document.getElementById('adminSendMessageBtn');
        const paymentMethods = document.querySelectorAll('.payment-method');
        const screenshotUpload = document.getElementById('screenshotUpload');
        const addFoodBtn = document.getElementById('addFoodBtn');
        const addFoodModal = document.getElementById('addFoodModal');
        const closeAddFood = document.getElementById('closeAddFood');
        const addFoodForm = document.getElementById('addFoodForm');
        const foodCategorySelect = document.getElementById('foodCategory');
        const foodImageInput = document.getElementById('foodImage');
        const imagePreview = document.getElementById('imagePreview');
        const addCategoryBtn = document.getElementById('addCategoryBtn');
        const addCategoryModal = document.getElementById('addCategoryModal');
        const closeAddCategory = document.getElementById('closeAddCategory');
        const addCategoryForm = document.getElementById('addCategoryForm');
        const viewOrdersBtn = document.getElementById('viewOrdersBtn');
        const ordersModal = document.getElementById('ordersModal');
        const closeOrders = document.getElementById('closeOrders');
        const ordersList = document.getElementById('ordersList');
        const toggleAdminModeBtn = document.getElementById('toggleAdminMode');
        const adminTimeElement = document.getElementById('adminTime');
        const userTimeElement = document.getElementById('userTime');
        const manageCategoriesBtn = document.getElementById('manageCategoriesBtn');
        const manageCategoriesModal = document.getElementById('manageCategoriesModal');
        const closeManageCategories = document.getElementById('closeManageCategories');
        const categoriesList = document.getElementById('categoriesList');
        const addNewCategoryBtn = document.getElementById('addNewCategoryBtn');
        const userChatList = document.getElementById('userChatList');
        const uploadImageBtn = document.getElementById('uploadImageBtn');
        const chatImageInput = document.getElementById('chatImageInput');
        const paymentScreenshotPreview = document.getElementById('paymentScreenshotPreview');
        const screenshotInput = document.getElementById('screenshot');
        
        // Initialize the app
        function init() {
            renderCategories();
            renderFoodItems('all');
            setupEventListeners();
            updateCartUI();
            updateTime();
            setInterval(updateTime, 60000); // Update time every minute
        }
        
        // Render categories
        function renderCategories() {
            categoryFiltersContainer.innerHTML = '';
            
            categories.forEach(category => {
                const categoryFilter = document.createElement('div');
                categoryFilter.className = 'category-filter';
                if (category.id === 'all') categoryFilter.classList.add('active');
                categoryFilter.dataset.category = category.id;
                categoryFilter.textContent = category.name;
                categoryFiltersContainer.appendChild(categoryFilter);
            });
            
            // Also update the category select in add food form
            foodCategorySelect.innerHTML = '';
            categories.filter(c => c.id !== 'all').forEach(category => {
                const option = document.createElement('option');
                option.value = category.id;
                option.textContent = category.name;
                foodCategorySelect.appendChild(option);
            });
        }
        
        // Render food items based on category
        function renderFoodItems(category) {
            foodItemsContainer.innerHTML = '';
            
            const filteredFoods = category === 'all' 
                ? foodItems 
                : foodItems.filter(item => item.category === category);
            
            if (filteredFoods.length === 0) {
                foodItemsContainer.innerHTML = '<p class="empty-menu">Ushbu kategoriyada hozircha taomlar mavjud emas.</p>';
                return;
            }
            
            filteredFoods.forEach(food => {
                const foodCard = document.createElement('div');
                foodCard.className = 'food-card';
                foodCard.innerHTML = `
                    <div class="food-image">
                        <img src="${food.image}" alt="${food.name}">
                    </div>
                    <div class="food-info">
                        <h3 class="food-title">${food.name}</h3>
                        <p class="food-description">${food.description}</p>
                        <p class="food-price">${food.price.toLocaleString()} so'm</p>
                        <div class="food-actions">
                            <div class="quantity">
                                <button class="quantity-btn minus" data-id="${food.id}">-</button>
                                <input type="number" class="quantity-input" value="1" min="1" data-id="${food.id}">
                                <button class="quantity-btn plus" data-id="${food.id}">+</button>
                            </div>
                            <button class="btn add-to-cart" data-id="${food.id}">Savatga</button>
                        </div>
                    </div>
                    <button class="delete-food" data-id="${food.id}">
                        <i class="fas fa-trash"></i>
                    </button>
                `;
                foodItemsContainer.appendChild(foodCard);
            });
            
            // Toggle admin mode
            if (isAdminMode) {
                document.body.classList.add('admin-mode');
            } else {
                document.body.classList.remove('admin-mode');
            }
        }
        
        // Set up event listeners
        function setupEventListeners() {
            // Category filters
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('category-filter')) {
                    document.querySelectorAll('.category-filter').forEach(f => f.classList.remove('active'));
                    e.target.classList.add('active');
                    renderFoodItems(e.target.dataset.category);
                }
            });
            
            // Cart modal
            cartIcon.addEventListener('click', () => {
                cartModal.style.display = 'flex';
                renderCartItems();
            });
            
            closeCart.addEventListener('click', () => {
                cartModal.style.display = 'none';
            });
            
            // Chat icon
            chatIcon.addEventListener('click', () => {
                chatModal.style.display = 'flex';
            });
            
            // Checkout modal
            checkoutBtn.addEventListener('click', () => {
                if (cart.length === 0) {
                    alert('Savatda mahsulot yo\'q!');
                    return;
                }
                cartModal.style.display = 'none';
                checkoutModal.style.display = 'flex';
            });
            
            closeCheckout.addEventListener('click', () => {
                checkoutModal.style.display = 'none';
            });
            
            // Checkout form
            checkoutForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                // Payment screenshotni olish
                const screenshotFile = screenshotInput.files[0];
                let paymentScreenshot = null;
                
                if (screenshotFile) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        paymentScreenshot = event.target.result;
                        completeOrderSubmission(paymentScreenshot);
                    };
                    reader.readAsDataURL(screenshotFile);
                } else {
                    completeOrderSubmission(null);
                }
            });
            
            // Payment method selection
            paymentMethods.forEach(method => {
                method.addEventListener('click', () => {
                    paymentMethods.forEach(m => m.classList.remove('selected'));
                    method.classList.add('selected');
                    currentPaymentMethod = method.dataset.method;
                    
                    if (currentPaymentMethod === 'online' || currentPaymentMethod === 'card') {
                        screenshotUpload.style.display = 'block';
                    } else {
                        screenshotUpload.style.display = 'none';
                    }
                });
            });
            
            // Payment screenshot preview
            screenshotInput.addEventListener('change', function() {
                const file = this.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.addEventListener('load', function() {
                        paymentScreenshotPreview.innerHTML = '';
                        const img = document.createElement('img');
                        img.src = this.result;
                        paymentScreenshotPreview.appendChild(img);
                    });
                    reader.readAsDataURL(file);
                }
            });
            
            // Chat modal
            sendMessageBtn.addEventListener('click', sendMessage);
            
            messageInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            closeChat.addEventListener('click', () => {
                chatModal.style.display = 'none';
            });
            
            // Admin chat
            adminSendMessageBtn.addEventListener('click', sendAdminMessage);
            
            adminMessageInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendAdminMessage();
                }
            });
            
            // Admin login
            adminLoginLink.addEventListener('click', (e) => {
                e.preventDefault();
                adminLoginModal.style.display = 'flex';
            });
            
            closeAdminLogin.addEventListener('click', () => {
                adminLoginModal.style.display = 'none';
            });
            
            adminLoginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                if (adminPassword.value === 'adminwep7') {
                    adminDashboard.style.display = 'block';
                    adminLoginModal.style.display = 'none';
                    isAdminMode = true;
                    document.body.classList.add('admin-mode');
                    // Scroll to admin dashboard
                    adminDashboard.scrollIntoView({ behavior: 'smooth' });
                    // Render user chat list
                    renderUserChatList();
                } else {
                    alert('Noto\'g\'ri parol!');
                }
            });
            
            // Add food modal
            addFoodBtn.addEventListener('click', () => {
                addFoodModal.style.display = 'flex';
            });
            
            closeAddFood.addEventListener('click', () => {
                addFoodModal.style.display = 'none';
            });
            
            // Image preview
            foodImageInput.addEventListener('change', function() {
                const file = this.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.addEventListener('load', function() {
                        imagePreview.innerHTML = '';
                        const img = document.createElement('img');
                        img.src = this.result;
                        imagePreview.appendChild(img);
                    });
                    reader.readAsDataURL(file);
                }
            });
            
            addFoodForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const file = foodImageInput.files[0];
                if (!file) {
                    alert('Iltimos, taom uchun rasm tanlang!');
                    return;
                }
                
                const reader = new FileReader();
                reader.addEventListener('load', function() {
                    const newFood = {
                        id: foodItems.length > 0 ? Math.max(...foodItems.map(item => item.id)) + 1 : 1,
                        name: document.getElementById('foodName').value,
                        description: document.getElementById('foodDescription').value,
                        price: parseInt(document.getElementById('foodPrice').value),
                        category: document.getElementById('foodCategory').value,
                        image: this.result
                    };
                    
                    foodItems.push(newFood);
                    saveDataToLocalStorage();
                    renderFoodItems('all');
                    addFoodModal.style.display = 'none';
                    addFoodForm.reset();
                    imagePreview.innerHTML = '<div class="image-preview-text">Rasm ko\'rinishi</div>';
                    alert('Yangi taom muvaffaqiyatli qo\'shildi!');
                });
                reader.readAsDataURL(file);
            });
            
            // Add category modal
            addCategoryBtn.addEventListener('click', () => {
                addCategoryModal.style.display = 'flex';
            });
            
            closeAddCategory.addEventListener('click', () => {
                addCategoryModal.style.display = 'none';
            });
            
            addCategoryForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const newCategory = {
                    id: document.getElementById('categoryId').value,
                    name: document.getElementById('categoryName').value
                };
                
                // Check if category already exists
                if (categories.some(c => c.id === newCategory.id)) {
                    alert('Bunday ID ga ega kategoriya mavjud!');
                    return;
                }
                
                categories.push(newCategory);
                saveDataToLocalStorage();
                renderCategories();
                addCategoryModal.style.display = 'none';
                addCategoryForm.reset();
                alert('Yangi kategoriya muvaffaqiyatli qo\'shildi!');
            });
            
            // View orders
            viewOrdersBtn.addEventListener('click', () => {
                ordersModal.style.display = 'flex';
                renderOrders();
            });
            
            closeOrders.addEventListener('click', () => {
                ordersModal.style.display = 'none';
            });
            
            // Toggle admin mode
            toggleAdminModeBtn.addEventListener('click', () => {
                isAdminMode = !isAdminMode;
                if (isAdminMode) {
                    document.body.classList.add('admin-mode');
                    toggleAdminModeBtn.textContent = 'Yopish';
                    renderUserChatList();
                } else {
                    document.body.classList.remove('admin-mode');
                    toggleAdminModeBtn.textContent = 'Ochish';
                }
                renderFoodItems('all');
            });
            
            // Kategoriyalarni boshqarish
            manageCategoriesBtn.addEventListener('click', () => {
                manageCategoriesModal.style.display = 'flex';
                renderCategoriesList();
            });
            
            closeManageCategories.addEventListener('click', () => {
                manageCategoriesModal.style.display = 'none';
            });
            
            addNewCategoryBtn.addEventListener('click', () => {
                manageCategoriesModal.style.display = 'none';
                addCategoryModal.style.display = 'flex';
            });
            
            // Chatga rasm yuklash
            uploadImageBtn.addEventListener('click', () => {
                chatImageInput.click();
            });
            
            chatImageInput.addEventListener('change', function() {
                const file = this.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.addEventListener('load', function() {
                        sendMessage(this.result, true);
                    });
                    reader.readAsDataURL(file);
                    this.value = ''; // Inputni tozalash
                }
            });
            
            // Close modals when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target === cartModal) cartModal.style.display = 'none';
                if (e.target === checkoutModal) checkoutModal.style.display = 'none';
                if (e.target === chatModal) chatModal.style.display = 'none';
                if (e.target === adminLoginModal) adminLoginModal.style.display = 'none';
                if (e.target === addFoodModal) addFoodModal.style.display = 'none';
                if (e.target === addCategoryModal) addCategoryModal.style.display = 'none';
                if (e.target === ordersModal) ordersModal.style.display = 'none';
                if (e.target === manageCategoriesModal) manageCategoriesModal.style.display = 'none';
            });
            
            // Delegate events for dynamic elements
            document.addEventListener('click', (e) => {
                // Add to cart buttons
                if (e.target.classList.contains('add-to-cart')) {
                    const foodId = parseInt(e.target.dataset.id);
                    const quantityInput = document.querySelector(`.quantity-input[data-id="${foodId}"]`);
                    const quantity = parseInt(quantityInput.value);
                    addToCart(foodId, quantity);
                    quantityInput.value = 1;
                }
                
                // Quantity buttons
                if (e.target.classList.contains('quantity-btn')) {
                    const foodId = parseInt(e.target.dataset.id);
                    const quantityInput = document.querySelector(`.quantity-input[data-id="${foodId}"]`);
                    let quantity = parseInt(quantityInput.value);
                    
                    if (e.target.classList.contains('plus')) {
                        quantityInput.value = quantity + 1;
                    } else if (e.target.classList.contains('minus') && quantity > 1) {
                        quantityInput.value = quantity - 1;
                    }
                }
                
                // Remove from cart buttons
                if (e.target.classList.contains('remove-from-cart')) {
                    const foodId = parseInt(e.target.dataset.id);
                    removeFromCart(foodId);
                }
                
                // Delete food buttons (for admin)
                if (e.target.classList.contains('delete-food') || e.target.closest('.delete-food')) {
                    const foodId = parseInt(e.target.dataset.id || e.target.closest('.delete-food').dataset.id);
                    deleteFoodItem(foodId);
                }
                
                // Admin chatida foydalanuvchini tanlash
                if (e.target.classList.contains('user-chat-item')) {
                    const userId = e.target.dataset.userId;
                    selectUserChat(userId);
                }
                
                // Delete order button
                if (e.target.classList.contains('delete-order')) {
                    const orderId = parseInt(e.target.dataset.orderId);
                    deleteOrder(orderId);
                }
                
                // Delete all orders button
                if (e.target.id === 'deleteAllOrdersBtn') {
                    deleteAllOrders();
                }
            });
        }
        
        // Buyurtmani yakunlash
        function completeOrderSubmission(paymentScreenshot) {
            const order = {
                id: Date.now(),
                customerName: document.getElementById('name').value,
                customerPhone: document.getElementById('phone').value,
                customerAddress: document.getElementById('address').value,
                items: [...cart],
                total: cart.reduce((total, item) => total + (item.price * item.quantity), 0),
                paymentMethod: currentPaymentMethod,
                paymentScreenshot: paymentScreenshot,
                status: 'pending',
                date: new Date().toLocaleString()
            };
            
            orders.push(order);
            saveDataToLocalStorage();
            
            // Send notification to admin
            addAdminMessage(`Yangi buyurtma: ${order.customerName}, ${order.customerPhone}, Jami: ${order.total.toLocaleString()} so'm`);
            
            // Foydalanuvchi bilan chat yaratish/yangilash
            const userId = order.customerPhone;
            if (!userChats[userId]) {
                userChats[userId] = {
                    name: order.customerName,
                    phone: order.customerPhone,
                    messages: []
                };
            }
            
            // Buyurtma haqida xabar qo'shish
            userChats[userId].messages.push({
                sender: 'system',
                message: `Yangi buyurtma: #${order.id}, Jami: ${order.total.toLocaleString()} so'm`,
                time: new Date().toLocaleTimeString(),
                isImage: false
            });
            
            saveDataToLocalStorage();
            
            alert('Buyurtmangiz qabul qilindi! Tez orada operator siz bilan bog\'lanadi.');
            checkoutModal.style.display = 'none';
            clearCart();
            checkoutForm.reset();
            paymentScreenshotPreview.innerHTML = '<div class="image-preview-text">Rasm ko\'rinishi</div>';
        }
        
        // Cart functions
        function addToCart(foodId, quantity) {
            const foodItem = foodItems.find(item => item.id === foodId);
            const existingItem = cart.find(item => item.id === foodId);
            
            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                cart.push({
                    id: foodItem.id,
                    name: foodItem.name,
                    price: foodItem.price,
                    image: foodItem.image,
                    quantity: quantity
                });
            }
            
            updateCartUI();
            saveDataToLocalStorage();
            
            // Show notification
            alert(`${quantity} ta ${foodItem.name} savatga qo'shildi!`);
        }
        
        function removeFromCart(foodId) {
            cart = cart.filter(item => item.id !== foodId);
            updateCartUI();
            saveDataToLocalStorage();
            renderCartItems();
        }
        
        function updateCartUI() {
            const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
            cartCountElement.textContent = totalItems;
            
            const totalPrice = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
            cartTotalElement.textContent = `${totalPrice.toLocaleString()} so'm`;
        }
        
        function renderCartItems() {
            cartItemsContainer.innerHTML = '';
            
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<p class="empty-cart">Savatda hech narsa yo\'q</p>';
                return;
            }
            
            cart.forEach(item => {
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <div class="cart-item-info">
                        <h4 class="cart-item-title">${item.name}</h4>
                        <p class="cart-item-price">${item.price.toLocaleString()} so'm x ${item.quantity}</p>
                    </div>
                    <button class="btn btn-danger remove-from-cart" data-id="${item.id}">
                        <i class="fas fa-trash"></i>
                    </button>
                `;
                cartItemsContainer.appendChild(cartItem);
            });
        }
        
        function clearCart() {
            cart = [];
            updateCartUI();
            saveDataToLocalStorage();
        }
        
        // Chat functions
        function sendMessage(message, isImage = false) {
            const messageText = messageInput.value.trim();
            if (messageText || isImage) {
                // Foydalanuvchi ma'lumotlarini olish
                const userData = {
                    name: document.getElementById('name') ? document.getElementById('name').value : localStorage.getItem('userName') || 'Foydalanuvchi',
                    phone: document.getElementById('phone') ? document.getElementById('phone').value : localStorage.getItem('userPhone') || 'Noma\'lum'
                };
                
                // UserChats obyektini yangilash
                const userId = userData.phone;
                
                if (!userChats[userId]) {
                    userChats[userId] = {
                        name: userData.name,
                        phone: userData.phone,
                        messages: []
                    };
                }
                
                // Xabarni qo'shish
                userChats[userId].messages.push({
                    sender: 'user',
                    message: isImage ? message : messageText,
                    time: new Date().toLocaleTimeString(),
                    isImage: isImage
                });
                
                // O'qilmagan xabarlar sonini oshirish
                unreadMessages[userId] = (unreadMessages[userId] || 0) + 1;
                
                // Saqlash
                saveDataToLocalStorage();
                
                // UI ni yangilash
                if (!isImage) {
                    messageInput.value = '';
                    addMessageToChat(messageText, 'user');
                } else {
                    addImageToChat(message, 'user');
                }
                
                // Admin rejimida bo'lsa, chat ro'yxatini yangilash
                if (isAdminMode) {
                    renderUserChatList();
                }
                
                // Admin javobini simulyatsiya qilish
                setTimeout(() => {
                    const responseMsg = isImage ? 
                        "Rasmni ko'rdim, tez orada javob beraman." : 
                        "Xabaringiz uchun rahmat! Tez orada javob beramiz.";
                    
                    userChats[userId].messages.push({
                        sender: 'admin',
                        message: responseMsg,
                        time: new Date().toLocaleTimeString(),
                        isImage: false
                    });
                    
                    saveDataToLocalStorage();
                    addMessageToChat(responseMsg, 'admin');
                }, 1000);
            }
        }
        
        function addMessageToChat(message, sender) {
            const messageElement = document.createElement('div');
            messageElement.className = `message ${sender}`;
            messageElement.innerHTML = `
                <p><strong>${sender === 'user' ? 'Siz' : 'Admin'}:</strong> ${message}</p>
                <div class="message-time">${new Date().toLocaleTimeString()}</div>
            `;
            chatMessagesContainer.appendChild(messageElement);
            chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;
            
            // Save to chat history
            chatMessages.push({
                sender: sender,
                message: message,
                time: new Date().toLocaleTimeString()
            });
            saveDataToLocalStorage();
        }
        
        // Rasm qo'shish funksiyasi
        function addImageToChat(imageData, sender) {
            const messageElement = document.createElement('div');
            messageElement.className = `message ${sender}`;
            messageElement.innerHTML = `
                <p><strong>${sender === 'user' ? 'Siz' : 'Admin'}:</strong></p>
                <img src="${imageData}" alt="Yuborilgan rasm" class="chat-image">
                <div class="message-time">${new Date().toLocaleTimeString()}</div>
            `;
            chatMessagesContainer.appendChild(messageElement);
            chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;
        }
        
        function sendAdminMessage() {
            const message = adminMessageInput.value.trim();
            if (message && activeChatUserId) {
                // Xabarni foydalanuvchi chatiga qo'shish
                userChats[activeChatUserId].messages.push({
                    sender: 'admin',
                    message: message,
                    time: new Date().toLocaleTimeString(),
                    isImage: false
                });
                
                // Saqlash
                saveDataToLocalStorage();
                
                // UI ni yangilash
                adminMessageInput.value = '';
                renderAdminChatMessages(activeChatUserId);
                
                // Foydalanuvchi chatiga ham xabarni qo'shish
                addMessageToChat(message, 'admin');
            }
        }
        
        function addAdminMessage(message, sender = 'admin') {
            const messageElement = document.createElement('div');
            messageElement.className = `message ${sender}`;
            messageElement.innerHTML = `
                <p><strong>${sender === 'user' ? 'Foydalanuvchi' : 'Admin'}:</strong> ${message}</p>
                <div class="message-time">${new Date().toLocaleTimeString()}</div>
            `;
            adminChatMessages.appendChild(messageElement);
            adminChatMessages.scrollTop = adminChatMessages.scrollHeight;
            
            // Save to chat history
            chatMessages.push({
                sender: sender,
                message: message,
                time: new Date().toLocaleTimeString()
            });
            saveDataToLocalStorage();
        }
        
        // Admin functions
        function deleteFoodItem(foodId) {
            if (confirm('Haqiqatan ham bu taomni o\'chirmoqchimisiz?')) {
                foodItems = foodItems.filter(item => item.id !== foodId);
                saveDataToLocalStorage();
                renderFoodItems('all');
                alert('Taom muvaffaqiyatli o\'chirildi!');
            }
        }
        
        // Kategoriyalar ro'yxatini chiqarish
        function renderCategoriesList() {
            categoriesList.innerHTML = '';
            
            categories.filter(c => c.id !== 'all').forEach(category => {
                const categoryItem = document.createElement('div');
                categoryItem.className = 'category-item';
                categoryItem.innerHTML = `
                    <div>
                        <h4>${category.name}</h4>
                        <p>ID: ${category.id}</p>
                    </div>
                    <div class="category-actions">
                        <button class="btn btn-danger delete-category" data-id="${category.id}">
                            <i class="fas fa-trash"></i> O'chirish
                        </button>
                    </div>
                `;
                categoriesList.appendChild(categoryItem);
            });
            
            // Kategoriya o'chirish tugmalariga event listener qo'shish
            document.querySelectorAll('.delete-category').forEach(btn => {
                btn.addEventListener('click', function() {
                    const categoryId = this.dataset.id;
                    deleteCategory(categoryId);
                });
            });
        }
        
        // Kategoriyani o'chirish
        function deleteCategory(categoryId) {
            // Kategoriyadan foydalanayotgan taomlar mavjudligini tekshirish
            const foodsInCategory = foodItems.filter(item => item.category === categoryId);
            
            if (foodsInCategory.length > 0) {
                alert(`Ushbu kategoriyada ${foodsInCategory.length} ta taom mavjud. Avval ularni o'chiring yoki boshqa kategoriyaga ko'chiring.`);
                return;
            }
            
            if (confirm(`"${categories.find(c => c.id === categoryId).name}" kategoriyasini o'chirmoqchimisiz?`)) {
                categories = categories.filter(c => c.id !== categoryId);
                saveDataToLocalStorage();
                renderCategories();
                renderCategoriesList();
                alert('Kategoriya muvaffaqiyatli o\'chirildi!');
            }
        }
        
        function renderOrders() {
            ordersList.innerHTML = '';
            
            if (orders.length === 0) {
                ordersList.innerHTML = '<p class="empty-orders">Hozircha buyurtmalar mavjud emas</p>';
                return;
            }
            
            // Delete all orders button
            const deleteAllBtn = document.createElement('button');
            deleteAllBtn.id = 'deleteAllOrdersBtn';
            deleteAllBtn.className = 'btn btn-danger';
            deleteAllBtn.innerHTML = '<i class="fas fa-trash"></i> Barcha Buyurtmalarni O\'chirish';
            deleteAllBtn.style.marginBottom = '1rem';
            ordersList.appendChild(deleteAllBtn);
            
            orders.forEach(order => {
                const orderElement = document.createElement('div');
                orderElement.className = 'order-item';
                orderElement.innerHTML = `
                    <div class="order-header">
                        <h4>Buyurtma #${order.id}</h4>
                        <div>
                            <span class="order-status ${order.status}">${order.status}</span>
                            <button class="btn btn-danger delete-order" data-order-id="${order.id}" style="margin-left: 10px;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="order-details">
                        <p><strong>Mijoz:</strong> ${order.customerName}</p>
                        <p><strong>Telefon:</strong> ${order.customerPhone}</p>
                        <p><strong>Manzil:</strong> ${order.customerAddress}</p>
                        <p><strong>To'lov usuli:</strong> ${order.paymentMethod}</p>
                        <p><strong>Jami:</strong> ${order.total.toLocaleString()} so'm</p>
                        <p><strong>Sana:</strong> ${order.date}</p>
                    </div>
                    <div class="order-items">
                        <h5>Buyurtma mahsulotlari:</h5>
                        <ul>
                            ${order.items.map(item => `<li>${item.name} - ${item.quantity} x ${item.price.toLocaleString()} so'm</li>`).join('')}
                        </ul>
                    </div>
                    ${order.paymentScreenshot ? `
                        <div class="payment-screenshot-container">
                            <h5>To'lov cheki:</h5>
                            <img src="${order.paymentScreenshot}" alt="To'lov cheki" class="payment-screenshot">
                        </div>
                    ` : ''}
                `;
                ordersList.appendChild(orderElement);
            });
        }
        
        // Buyurtmani o'chirish
        function deleteOrder(orderId) {
            if (confirm('Haqiqatan ham bu buyurtmani o\'chirmoqchimisiz?')) {
                orders = orders.filter(order => order.id !== orderId);
                saveDataToLocalStorage();
                renderOrders();
                alert('Buyurtma muvaffaqiyatli o\'chirildi!');
            }
        }
        
        // Barcha buyurtmalarni o'chirish
        function deleteAllOrders() {
            if (confirm('Haqiqatan ham BARCHA buyurtmalarni o\'chirmoqchimisiz? Bu amalni ortga qaytarib bo\'lmaydi!')) {
                orders = [];
                saveDataToLocalStorage();
                renderOrders();
                alert('Barcha buyurtmalar muvaffaqiyatli o\'chirildi!');
            }
        }
        
        // Foydalanuvchi chatlar ro'yxatini chiqarish (admin uchun)
        function renderUserChatList() {
            userChatList.innerHTML = '';
            
            // Har bir foydalanuvchi uchun chat elementini yaratish
            Object.keys(userChats).forEach(userId => {
                const user = userChats[userId];
                const unread = unreadMessages[userId] || 0;
                
                const userItem = document.createElement('div');
                userItem.className = `user-chat-item ${activeChatUserId === userId ? 'active' : ''}`;
                userItem.dataset.userId = userId;
                userItem.innerHTML = `
                    <div class="user-info">
                        <span class="user-name">${user.name || 'Noma\'lum foydalanuvchi'}</span>
                        <span class="user-phone">${user.phone || 'Telefon raqami yo\'q'}</span>
                    </div>
                    ${unread > 0 ? `<span class="unread-count">${unread}</span>` : ''}
                `;
                userChatList.appendChild(userItem);
            });
            
            // Agar hech bo'lmaganda bitta foydalanuvchi bo'lsa, birinchisini tanlash
            if (Object.keys(userChats).length > 0 && !activeChatUserId) {
                selectUserChat(Object.keys(userChats)[0]);
            }
        }
        
        // Foydalanuvchi chatini tanlash
        function selectUserChat(userId) {
            activeChatUserId = userId;
            
            // Tanlangan foydalanuvchini belgilash
            document.querySelectorAll('.user-chat-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.userId === userId) {
                    item.classList.add('active');
                }
            });
            
            // Chat xabarlarini ko'rsatish
            renderAdminChatMessages(userId);
            
            // O'qilmagan xabarlarni nolga tushirish
            unreadMessages[userId] = 0;
            saveDataToLocalStorage();
        }
        
        // Admin chatida xabarlarni ko'rsatish
        function renderAdminChatMessages(userId) {
            adminChatMessages.innerHTML = '';
            
            if (userChats[userId] && userChats[userId].messages) {
                userChats[userId].messages.forEach(msg => {
                    const messageElement = document.createElement('div');
                    messageElement.className = `message ${msg.sender}`;
                    
                    if (msg.isImage) {
                        messageElement.innerHTML = `
                            <p><strong>${msg.sender === 'user' ? (userChats[userId].name || 'Foydalanuvchi') : (msg.sender === 'system' ? 'Tizim' : 'Admin')}:</strong></p>
                            <img src="${msg.message}" alt="Yuborilgan rasm" class="chat-image">
                            <div class="message-time">${msg.time}</div>
                        `;
                    } else {
                        messageElement.innerHTML = `
                            <p><strong>${msg.sender === 'user' ? (userChats[userId].name || 'Foydalanuvchi') : (msg.sender === 'system' ? 'Tizim' : 'Admin')}:</strong> ${msg.message}</p>
                            <div class="message-time">${msg.time}</div>
                        `;
                    }
                    
                    adminChatMessages.appendChild(messageElement);
                });
            }
            
            adminChatMessages.scrollTop = adminChatMessages.scrollHeight;
        }
        
        // Utility functions
        function saveDataToLocalStorage() {
            localStorage.setItem('foodItems', JSON.stringify(foodItems));
            localStorage.setItem('categories', JSON.stringify(categories));
            localStorage.setItem('orders', JSON.stringify(orders));
            localStorage.setItem('cart', JSON.stringify(cart));
            localStorage.setItem('chatMessages', JSON.stringify(chatMessages));
            localStorage.setItem('userChats', JSON.stringify(userChats));
            localStorage.setItem('unreadMessages', JSON.stringify(unreadMessages));
            
            // Foydalanuvchi ma'lumotlarini saqlash
            if (document.getElementById('name')) {
                localStorage.setItem('userName', document.getElementById('name').value);
            }
            if (document.getElementById('phone')) {
                localStorage.setItem('userPhone', document.getElementById('phone').value);
            }
        }
        
        function updateTime() {
            const now = new Date().toLocaleTimeString();
            if (adminTimeElement) adminTimeElement.textContent = now;
            if (userTimeElement) userTimeElement.textContent = now;
        }
        
        // Initialize the app
        init();
    </script>
</body>
</html>